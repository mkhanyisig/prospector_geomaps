<html>
<head>

<title>Prospector USGCS Map Data </title>
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css'>

<style>

body {
 background-color:lightgray;
 text-align: center;
}
h1, h3, p{
  text-align:center;
}
/* ------------------------------------------ */

path {
  stroke: red;
  stroke-width: 0.5px;
  fill: orange;
}

#tooltip {
  text-align: left;
  padding: 16px;
  background-color: lightsalmon;
  border: 1px solid black;
  width: auto;
  opacity: 0;
  color: black;
  position: absolute;
}

/*
 * Footer
 */
a:link    {color:orangered;  text-decoration:none}
a:visited {color:orangered; text-decoration:none}
a:hover   {color:red; text-decoration:underline}

.tableFooter{
  margin-top: 15px;
}
.footerSvg{
  width: 32px;
}


</style>



</head>

<body>

<h1>Prospector Map Data Proof of Concept Test</h1>

<h5>Zoom in/out | Hover over the data point for additional data (to be added)</h5>

<div id="map"></div>

<!-- Create an element where the map will take place -->
<svg id="my_dataviz" width="1000" height="480"></svg>

<div id="tooltip">
  Name: <span id="name" class="info"></span><br>
  Nametype: <span id="nametype" class="info"></span><br>
  Fall: <span id="fall" class="info"></span><br>
  Mass: <span id="mass" class="info"></span><br>
  Recclass: <span id="reclass" class="info"></span><br>
  Reclat: <span id="reclat" class="info"></span><br>
  Reclong: <span id="reclong" class="info"></span><br>
  Year: <span id="year" class="info"></span>
</div>

<div id="btn-zoom">
  <i id="btn-zoom--in" class="fa fa-search-plus fa-2x" ></i>
  <i id="btn-zoom--out"class="fa fa-search-minus fa-2x" ></i>
</div>

<!-- load libraries at end -->

<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://unpkg.com/topojson-client@3"></script>
<script src="https://d3js.org/d3-geo.v1.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>


<script>

// main script

// The svg
var svg = d3.select("svg"),
    width = +svg.attr("width"),
    height = +svg.attr("height");

console.log("width: "+width+"  height: "+height);


// Map and projection
var path = d3.geoPath();
var projection = d3.geoNaturalEarth()
    //.center([1, 32])  // coordinates to center on
    .scale(width / 1.3 / Math.PI)  // adjust denominator to scale well
    .translate([width / 2, height / 2])
var path = d3.geoPath()
    .projection(projection);


// zoom feature
const zoom = d3.zoom()
.scaleExtent([0.5, 20]) //  minimum and maximum allowed scale factor of original
    .translateExtent([[0,0], [width*2, height*2]]) // top left corner, top right corner
    .extent([[0, 0], [width, height]]) //
    .on("zoom", zoomed);

svg.on("dblclick.zoom", null)


var g = svg.append("g");

// color
// Create data
var dt = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L"]

var myColor = d3.scaleOrdinal().domain(dt)
  .range(d3.schemeDark2);

// Load external data and boot => world map
d3.json("https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson", function(data){

  console.log(data);


    // Draw the map
    g.
    selectAll("path")
    .data(data.features)
    .enter().append("path")
        .attr("fill", "#69b3a2")
        .attr("d", d3.geoPath()
            .projection(projection)
        )
        .style("stroke", "#fff")
});

// Add all points onto map ()
d3.json("https://raw.githubusercontent.com/mkhanyisig/RandomCodeSamples/master/JSON%20file/test.json",function(data){
    console.log(data);

    // Add circles:
  g.
    selectAll("myCircles")
    .data(data.features)
    .enter()
    .append("circle")
      .attr("cx", function(d){ return projection([+d.geometry.coordinates[0], +d.geometry.coordinates[1]])[0] })
      .attr("cy", function(d){ return projection([+d.geometry.coordinates[0], +d.geometry.coordinates[1]])[1] })
      .attr("r", 4)
      .style("fill", function(d,i){;return myColor(i);})
      //.attr("stroke", function(d){ if(d.n>2000){return "black"}else{return "none"}  })
      .attr("stroke-width", 3)
      .attr("fill-opacity", .4)
      //.call(zoom)
});


// event handlers
const ZOOM_DURATION = 10;
const ZOOM_IN_STEP = 2;
const ZOOM_OUT_STEP=-2;

d3.select("#btn-zoom--in").on("click", () => clickToZoom(ZOOM_IN_STEP));
d3.select("#btn-zoom--out").on("click", () => clickToZoom(ZOOM_OUT_STEP));

function zoomed(){

  g.attr("transform", d3.event.transform);

}

function clickToZoom(zoomStep) {
  svg
    .transition()
    .duration(ZOOM_DURATION)
    .call(zoom.scaleBy, zoomStep);
}




</script>


</body>

</html>
